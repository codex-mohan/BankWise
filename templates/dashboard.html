<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BankWise Data Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      :root {
        --github-blue: #0969da;
        --github-green: #1a7f37;
        --github-purple: #8250df;
        --github-red: #cf222e;
        --github-orange: #bc4c00;
        --github-bg: #ffffff;
        --github-text: #24292f;
        --github-border: #d0d7de;
        --github-badge-bg: #f6f8fa;
      }

      [data-bs-theme="dark"] {
        --github-blue: #58a6ff;
        --github-green: #3fb950;
        --github-purple: #d2a8ff;
        --github-red: #ff7b72;
        --github-orange: #ffa657;
        --github-bg: #0d1117;
        --github-text: #c9d1d9;
        --github-border: #30363d;
        --github-badge-bg: #161b22;
      }

      body {
        background-color: var(--github-bg);
        color: var(--github-text);
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, sans-serif;
      }

      .sidebar {
        background-color: var(--github-badge-bg);
        border-right: 1px solid var(--github-border);
        height: 100vh;
        position: fixed;
        top: 0;
        left: 0;
        overflow-y: auto;
        z-index: 100;
        padding-top: 20px;
        width: 250px;
      }

      .main-content {
        margin-left: 250px;
        padding: 20px;
        transition: margin-left 0.3s;
      }

      .sidebar-header {
        padding: 0 20px 20px;
        border-bottom: 1px solid var(--github-border);
        margin-bottom: 15px;
      }

      .data-item {
        padding: 12px 20px;
        border-bottom: 1px solid var(--github-border);
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
      }

      .data-item::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 3px;
        background: linear-gradient(
          135deg,
          var(--github-blue),
          var(--github-purple)
        );
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .data-item:hover {
        background: linear-gradient(
          90deg,
          rgba(9, 105, 218, 0.1),
          rgba(130, 80, 223, 0.05)
        );
        color: var(--github-blue);
        transform: translateX(3px);
      }

      .data-item:hover::before {
        transform: translateX(0);
      }

      .data-item:hover i {
        transform: scale(1.1);
        color: var(--github-blue);
      }

      .data-item.active {
        background: linear-gradient(
          90deg,
          var(--github-blue),
          var(--github-purple)
        );
        color: white;
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(9, 105, 218, 0.3);
      }

      .data-item.active::before {
        transform: translateX(0);
        background: linear-gradient(135deg, #ffffff, rgba(255, 255, 255, 0.8));
      }

      .data-item.active i {
        color: white;
        transform: scale(1.1);
      }

      .data-item i {
        transition: all 0.3s ease;
        font-size: 14px;
        width: 16px;
        text-align: center;
      }

      /* Dark theme adjustments for sidebar */
      [data-bs-theme="dark"] .data-item:hover {
        background: linear-gradient(
          90deg,
          rgba(88, 166, 255, 0.1),
          rgba(210, 168, 255, 0.05)
        );
        color: #58a6ff;
      }

      [data-bs-theme="dark"] .data-item.active {
        background: linear-gradient(90deg, #58a6ff, #d2a8ff);
      }

      .table-container {
        overflow-x: auto;
        max-height: 75vh;
        border: 1px solid var(--github-border);
        border-radius: 0;
      }

      .table {
        border-collapse: separate;
        border-spacing: 0;
        border: none;
      }

      .table th {
        background-color: var(--github-badge-bg);
        color: var(--github-text);
        border-bottom: 2px solid var(--github-border);
        position: sticky;
        top: 0;
        z-index: 10;
        padding: 12px 15px;
      }

      .table td {
        padding: 10px 15px;
        border-bottom: 1px solid var(--github-border);
      }

      .table tr:hover td {
        background-color: rgba(9, 105, 218, 0.1);
      }

      .theme-toggle {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--github-blue);
        color: white;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        border: none;
      }

      .loading-spinner {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1000;
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 5px solid rgba(9, 105, 218, 0.3);
        border-top: 5px solid var(--github-blue);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .badge {
        background-color: var(--github-badge-bg);
        color: var(--github-text);
        border: 1px solid var(--github-border);
        border-radius: 0;
        padding: 5px 10px;
        font-weight: normal;
        margin-right: 5px;
        margin-bottom: 5px;
      }

      .github-blue {
        background-color: var(--github-blue);
        color: white;
      }
      .github-green {
        background-color: var(--github-green);
        color: white;
      }
      .github-purple {
        background-color: var(--github-purple);
        color: white;
      }
      .github-red {
        background-color: var(--github-red);
        color: white;
      }
      .github-orange {
        background-color: var(--github-orange);
        color: white;
      }

      .header-bg {
        background: linear-gradient(
          to right,
          var(--github-blue),
          var(--github-purple)
        );
        color: white;
        padding: 1.5rem 0;
        border-radius: 0;
        margin-bottom: 20px;
      }

      /* Agent Cards Styling */
      .agents-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 20px;
        padding: 20px 0;
      }

      .agent-card {
        background: var(--github-badge-bg);
        border: 1px solid var(--github-border);
        border-radius: 12px;
        padding: 20px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        animation: fadeInUp 0.5s ease forwards;
        opacity: 0;
      }

      .agent-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        border-color: var(--github-blue);
      }

      .agent-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--github-blue),
          var(--github-purple),
          var(--github-green)
        );
        animation: shimmer 2s infinite;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes shimmer {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }

      .agent-header {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
      }

      .agent-avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--github-blue),
          var(--github-purple)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: bold;
        margin-right: 15px;
        position: relative;
        overflow: hidden;
      }

      .agent-avatar::after {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(
          45deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        animation: shine 3s infinite;
      }

      @keyframes shine {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .agent-info h5 {
        margin: 0;
        color: var(--github-text);
        font-size: 18px;
        font-weight: 600;
      }

      .agent-info p {
        margin: 5px 0 0;
        color: var(--github-text);
        opacity: 0.7;
        font-size: 14px;
      }

      .agent-status {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 500;
        margin-bottom: 10px;
      }

      .status-available {
        background: linear-gradient(135deg, var(--github-green), #2ea043);
        color: white;
      }

      .status-busy {
        background: linear-gradient(135deg, var(--github-orange), #e36209);
        color: white;
      }

      .status-break {
        background: linear-gradient(135deg, var(--github-purple), #8957e5);
        color: white;
      }

      .status-training {
        background: linear-gradient(135deg, var(--github-blue), #0969da);
        color: white;
      }

      .status-off {
        background: linear-gradient(135deg, var(--github-red), #cf222e);
        color: white;
      }

      .agent-details {
        margin-top: 15px;
      }

      .detail-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 13px;
      }

      .detail-label {
        color: var(--github-text);
        opacity: 0.6;
      }

      .detail-value {
        color: var(--github-text);
        font-weight: 500;
      }

      .agent-skills {
        margin-top: 15px;
      }

      .skill-badge {
        display: inline-block;
        padding: 3px 8px;
        background: rgba(9, 105, 218, 0.1);
        color: var(--github-blue);
        border: 1px solid rgba(9, 105, 218, 0.2);
        border-radius: 12px;
        font-size: 11px;
        margin: 2px;
        transition: all 0.2s;
      }

      .skill-badge:hover {
        background: rgba(9, 105, 218, 0.2);
        transform: scale(1.05);
      }

      .agent-metrics {
        display: flex;
        justify-content: space-between;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid var(--github-border);
      }

      .metric {
        text-align: center;
      }

      .metric-value {
        font-size: 16px;
        font-weight: bold;
        color: var(--github-blue);
      }

      .metric-label {
        font-size: 11px;
        color: var(--github-text);
        opacity: 0.6;
        margin-top: 2px;
      }

      /* Dark theme adjustments for agent cards */
      [data-bs-theme="dark"] .agent-card {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      [data-bs-theme="dark"] .agent-card:hover {
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      }

      [data-bs-theme="dark"] .skill-badge {
        background: rgba(88, 166, 255, 0.1);
        color: var(--github-blue);
        border-color: rgba(88, 166, 255, 0.2);
      }

      [data-bs-theme="dark"] .skill-badge:hover {
        background: rgba(88, 166, 255, 0.2);
      }

      /* Responsive design */
      @media (max-width: 768px) {
        .agents-container {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .agent-card {
          padding: 15px;
        }

        .agent-avatar {
          width: 50px;
          height: 50px;
          font-size: 20px;
        }
      }

      /* Home Dashboard Styles */
      .home-dashboard {
        display: none;
        padding: 20px 0;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: var(--github-badge-bg);
        border: 1px solid var(--github-border);
        border-radius: 12px;
        padding: 20px;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }

      .stat-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--github-blue),
          var(--github-purple)
        );
      }

      .stat-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--github-blue),
          var(--github-purple)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 20px;
        margin-bottom: 15px;
      }

      .stat-value {
        font-size: 28px;
        font-weight: bold;
        color: var(--github-text);
        margin-bottom: 5px;
      }

      .stat-label {
        color: var(--github-text);
        opacity: 0.7;
        font-size: 14px;
      }

      .stat-change {
        position: absolute;
        top: 20px;
        right: 20px;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
      }

      .stat-change.positive {
        background: rgba(26, 127, 55, 0.1);
        color: var(--github-green);
      }

      .stat-change.negative {
        background: rgba(207, 34, 46, 0.1);
        color: var(--github-red);
      }

      .charts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
        gap: 25px;
        margin-bottom: 30px;
      }

      .chart-card {
        background: var(--github-badge-bg);
        border: 1px solid var(--github-border);
        border-radius: 12px;
        padding: 20px;
        height: 350px;
        display: flex;
        flex-direction: column;
      }

      .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        flex-shrink: 0;
      }

      .chart-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--github-text);
      }

      .chart-options {
        display: flex;
        gap: 10px;
      }

      .chart-option {
        padding: 4px 8px;
        border: 1px solid var(--github-border);
        border-radius: 6px;
        background: transparent;
        color: var(--github-text);
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .chart-option:hover,
      .chart-option.active {
        background: var(--github-blue);
        color: white;
        border-color: var(--github-blue);
      }

      .chart-container {
        flex: 1;
        position: relative;
        min-height: 0;
      }

      .chart-container canvas {
        max-height: 250px !important;
      }

      .activity-feed {
        background: var(--github-badge-bg);
        border: 1px solid var(--github-border);
        border-radius: 12px;
        padding: 20px;
        max-height: 400px;
        overflow-y: auto;
      }

      .activity-item {
        display: flex;
        align-items: start;
        padding: 12px 0;
        border-bottom: 1px solid var(--github-border);
      }

      .activity-item:last-child {
        border-bottom: none;
      }

      .activity-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 15px;
        flex-shrink: 0;
      }

      .activity-content {
        flex: 1;
      }

      .activity-title {
        font-weight: 500;
        color: var(--github-text);
        margin-bottom: 4px;
      }

      .activity-description {
        color: var(--github-text);
        opacity: 0.7;
        font-size: 14px;
      }

      .activity-time {
        color: var(--github-text);
        opacity: 0.5;
        font-size: 12px;
        margin-top: 4px;
      }

      .quick-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 30px;
      }

      .action-card {
        background: var(--github-badge-bg);
        border: 1px solid var(--github-border);
        border-radius: 12px;
        padding: 20px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .action-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        border-color: var(--github-blue);
      }

      .action-icon {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--github-blue),
          var(--github-purple)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        margin: 0 auto 15px;
      }

      .action-title {
        font-weight: 600;
        color: var(--github-text);
        margin-bottom: 5px;
      }

      .action-description {
        color: var(--github-text);
        opacity: 0.7;
        font-size: 14px;
      }

      /* Search Feature Styles */
      .search-container {
        background: var(--github-badge-bg);
        border: 1px solid var(--github-border);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .search-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .search-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--github-text);
      }

      .search-controls {
        display: flex;
        gap: 15px;
        align-items: center;
        flex-wrap: wrap;
      }

      .search-input-group {
        position: relative;
        flex: 1;
        min-width: 300px;
      }

      .search-input {
        width: 100%;
        padding: 10px 15px 10px 40px;
        border: 1px solid var(--github-border);
        border-radius: 8px;
        background: var(--github-bg);
        color: var(--github-text);
        font-size: 14px;
        transition: all 0.3s ease;
      }

      .search-input:focus {
        outline: none;
        border-color: var(--github-blue);
        box-shadow: 0 0 0 3px rgba(9, 105, 218, 0.1);
      }

      .search-icon {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--github-text);
        opacity: 0.5;
      }

      .search-filter {
        padding: 8px 12px;
        border: 1px solid var(--github-border);
        border-radius: 6px;
        background: var(--github-bg);
        color: var(--github-text);
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .search-filter:focus {
        outline: none;
        border-color: var(--github-blue);
      }

      .search-stats {
        display: flex;
        gap: 20px;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid var(--github-border);
      }

      .search-stat {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--github-text);
        opacity: 0.8;
        font-size: 14px;
      }

      .search-stat-icon {
        color: var(--github-blue);
      }

      .search-highlight {
        background-color: rgba(9, 105, 218, 0.2);
        color: var(--github-blue);
        padding: 1px 2px;
        border-radius: 2px;
        font-weight: 500;
      }

      .no-results {
        text-align: center;
        padding: 40px;
        color: var(--github-text);
        opacity: 0.7;
      }

      .no-results-icon {
        font-size: 48px;
        margin-bottom: 15px;
        opacity: 0.5;
      }

      /* Dark theme adjustments for home dashboard */
      [data-bs-theme="dark"] .stat-card,
      [data-bs-theme="dark"] .chart-card,
      [data-bs-theme="dark"] .activity-feed,
      [data-bs-theme="dark"] .action-card,
      [data-bs-theme="dark"] .search-container {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      [data-bs-theme="dark"] .stat-card:hover,
      [data-bs-theme="dark"] .chart-card:hover,
      [data-bs-theme="dark"] .action-card:hover,
      [data-bs-theme="dark"] .search-container:hover {
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      }
    </style>
  </head>
  <body>
    <div class="sidebar">
      <div class="sidebar-header">
        <h4><i class="fas fa-database me-2"></i>Data Sources</h4>
        <div class="form-check form-switch mt-2">
          <input class="form-check-input" type="checkbox" id="sourceToggle" />
          <label class="form-check-label" for="sourceToggle"
            >Use Database</label
          >
        </div>
      </div>

      <div class="data-list">
        <div class="data-item active" data-type="home">
          <i class="fas fa-home me-2"></i>Dashboard Home
        </div>
        <div class="data-item" data-type="accounts">
          <i class="fas fa-wallet me-2"></i>Accounts
        </div>
        <div class="data-item" data-type="transactions">
          <i class="fas fa-exchange-alt me-2"></i>Transactions
        </div>
        <div class="data-item" data-type="branches">
          <i class="fas fa-building me-2"></i>Branches
        </div>
        <div class="data-item" data-type="atms">
          <i class="fas fa-credit-card me-2"></i>ATMs
        </div>
        <div class="data-item" data-type="agents">
          <i class="fas fa-user-tie me-2"></i>Agents
        </div>
        <div class="data-item" data-type="complaints">
          <i class="fas fa-comment-dots me-2"></i>Complaints
        </div>
        <div class="data-item" data-type="disputes">
          <i class="fas fa-gavel me-2"></i>Disputes
        </div>
        <div class="data-item" data-type="loans">
          <i class="fas fa-hand-holding-usd me-2"></i>Loans
        </div>
        <div class="data-item" data-type="fd_rates">
          <i class="fas fa-percentage me-2"></i>FD Rates
        </div>
        <div class="data-item" data-type="cards">
          <i class="fas fa-credit-card me-2"></i>Cards
        </div>
        <div class="data-item" data-type="cheques">
          <i class="fas fa-money-check me-2"></i>Cheques
        </div>
      </div>
    </div>

    <div class="main-content">
      <!-- Home Dashboard View -->
      <div class="home-dashboard" id="homeDashboard">
        <div class="header-bg">
          <div class="container">
            <h1 class="display-6">
              <i class="fas fa-chart-line me-3"></i>BankWise Analytics Dashboard
            </h1>
            <p class="lead">Real-time banking insights and metrics</p>
          </div>
        </div>

        <div class="container">
          <!-- Quick Actions -->
          <div class="quick-actions">
            <div class="action-card" onclick="navigateToData('accounts')">
              <div class="action-icon">
                <i class="fas fa-wallet"></i>
              </div>
              <div class="action-title">Manage Accounts</div>
              <div class="action-description">
                View and manage customer accounts
              </div>
            </div>
            <div class="action-card" onclick="navigateToData('transactions')">
              <div class="action-icon">
                <i class="fas fa-exchange-alt"></i>
              </div>
              <div class="action-title">Transaction History</div>
              <div class="action-description">
                Monitor all banking transactions
              </div>
            </div>
            <div class="action-card" onclick="navigateToData('loans')">
              <div class="action-icon">
                <i class="fas fa-hand-holding-usd"></i>
              </div>
              <div class="action-title">Loan Portfolio</div>
              <div class="action-description">
                Track loan applications and status
              </div>
            </div>
            <div class="action-card" onclick="navigateToData('agents')">
              <div class="action-icon">
                <i class="fas fa-user-tie"></i>
              </div>
              <div class="action-title">Agent Performance</div>
              <div class="action-description">
                Monitor agent metrics and availability
              </div>
            </div>
          </div>

          <!-- Statistics Grid -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-users"></i>
              </div>
              <div class="stat-value" id="totalAccounts">0</div>
              <div class="stat-label">Total Accounts</div>
              <div class="stat-change positive">+12.5%</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-rupee-sign"></i>
              </div>
              <div class="stat-value" id="totalBalance">â‚¹0</div>
              <div class="stat-label">Total Balance</div>
              <div class="stat-change positive">+8.3%</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-credit-card"></i>
              </div>
              <div class="stat-value" id="activeCards">0</div>
              <div class="stat-label">Active Cards</div>
              <div class="stat-change negative">-2.1%</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-user-tie"></i>
              </div>
              <div class="stat-value" id="availableAgents">0</div>
              <div class="stat-label">Available Agents</div>
              <div class="stat-change positive">+5.7%</div>
            </div>
          </div>

          <!-- Charts Grid -->
          <div class="charts-grid">
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Account Types Distribution</div>
                <div class="chart-options">
                  <button
                    class="chart-option active"
                    onclick="updateAccountChart('type')"
                  >
                    Type
                  </button>
                  <button
                    class="chart-option"
                    onclick="updateAccountChart('status')"
                  >
                    Status
                  </button>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="accountChart"></canvas>
              </div>
            </div>
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Transaction Trends</div>
                <div class="chart-options">
                  <button
                    class="chart-option active"
                    onclick="updateTransactionChart('daily')"
                  >
                    Daily
                  </button>
                  <button
                    class="chart-option"
                    onclick="updateTransactionChart('weekly')"
                  >
                    Weekly
                  </button>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="transactionChart"></canvas>
              </div>
            </div>
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Loan Portfolio</div>
                <div class="chart-options">
                  <button
                    class="chart-option active"
                    onclick="updateLoanChart('type')"
                  >
                    Type
                  </button>
                  <button
                    class="chart-option"
                    onclick="updateLoanChart('status')"
                  >
                    Status
                  </button>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="loanChart"></canvas>
              </div>
            </div>
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Agent Performance</div>
                <div class="chart-options">
                  <button
                    class="chart-option active"
                    onclick="updateAgentChart('availability')"
                  >
                    Availability
                  </button>
                  <button
                    class="chart-option"
                    onclick="updateAgentChart('performance')"
                  >
                    Performance
                  </button>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="agentChart"></canvas>
              </div>
            </div>
          </div>

          <!-- Activity Feed -->
          <div class="row">
            <div class="col-md-6">
              <div class="activity-feed">
                <div class="chart-header">
                  <div class="chart-title">Recent Activities</div>
                </div>
                <div id="activityFeed">
                  <!-- Activities will be populated here -->
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="activity-feed">
                <div class="chart-header">
                  <div class="chart-title">System Alerts</div>
                </div>
                <div id="alertsFeed">
                  <!-- Alerts will be populated here -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Data Views (Existing) -->
      <div id="dataViews" style="display: none">
        <div class="header-bg">
          <div class="container">
            <h1 class="display-6">
              <i class="fas fa-table me-3"></i>BankWise Data Dashboard
            </h1>
            <p class="lead">
              Viewing: <span id="currentDataType">Accounts</span>
            </p>
          </div>
        </div>

        <div class="container mb-5">
          <!-- Search Container (Accounts) -->
          <div
            class="search-container"
            id="accountsSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search Accounts
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="accountsSearchInput"
                  placeholder="Search by account number, name, mobile..."
                />
              </div>
              <select class="search-filter" id="accountTypeFilter">
                <option value="">All Account Types</option>
                <option value="Savings">Savings</option>
                <option value="Current">Current</option>
                <option value="Salary">Salary</option>
              </select>
              <select class="search-filter" id="accountStatusFilter">
                <option value="">All Statuses</option>
                <option value="ACTIVE">Active</option>
                <option value="INACTIVE">Inactive</option>
                <option value="FROZEN">Frozen</option>
              </select>
              <select class="search-filter" id="kycStatusFilter">
                <option value="">All KYC Status</option>
                <option value="VERIFIED">Verified</option>
                <option value="PENDING">Pending</option>
                <option value="UNDER_REVIEW">Under Review</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('accounts')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="accountsSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (Transactions) -->
          <div
            class="search-container"
            id="transactionsSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search Transactions
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="transactionsSearchInput"
                  placeholder="Search by ID, account number, description..."
                />
              </div>
              <select class="search-filter" id="transactionTypeFilter">
                <option value="">All Types</option>
                <option value="DEPOSIT">Deposit</option>
                <option value="WITHDRAWAL">Withdrawal</option>
                <option value="TRANSFER">Transfer</option>
                <option value="PURCHASE">Purchase</option>
                <option value="CASHBACK">Cashback</option>
                <option value="INTEREST">Interest</option>
              </select>
              <select class="search-filter" id="transactionStatusFilter">
                <option value="">All Statuses</option>
                <option value="COMPLETED">Completed</option>
                <option value="PENDING">Pending</option>
                <option value="FAILED">Failed</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('transactions')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="transactionsSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (Branches) -->
          <div
            class="search-container"
            id="branchesSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search Branches
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="branchesSearchInput"
                  placeholder="Search by name, city, IFSC, manager..."
                />
              </div>
              <select class="search-filter" id="branchTypeFilter">
                <option value="">All Branch Types</option>
                <option value="FULL_SERVICE">Full Service</option>
                <option value="CORPORATE">Corporate</option>
                <option value="RURAL">Rural</option>
                <option value="BUSINESS_CENTER">Business Center</option>
              </select>
              <select class="search-filter" id="branchFacilitiesFilter">
                <option value="">All Facilities</option>
                <option value="NET_BANKING">Net Banking</option>
                <option value="LOAN_SERVICES">Loan Services</option>
                <option value="DEMAT_SERVICES">Demat Services</option>
                <option value="FOREX">Forex</option>
                <option value="LOCKER">Locker</option>
                <option value="MOBILE_BANKING">Mobile Banking</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('branches')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="branchesSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (ATMs) -->
          <div
            class="search-container"
            id="atmsSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search ATMs
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="atmsSearchInput"
                  placeholder="Search by ID, city, address..."
                />
              </div>
              <select class="search-filter" id="atmTypeFilter">
                <option value="">All Types</option>
                <option value="ON_SITE">On-Site</option>
                <option value="OFF_SITE">Off-Site</option>
              </select>
              <select class="search-filter" id="atmStatusFilter">
                <option value="">All Statuses</option>
                <option value="ACTIVE">Active</option>
                <option value="OUT_OF_SERVICE">Out of Service</option>
                <option value="MAINTENANCE">Maintenance</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('atms')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="atmsSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (Agents) -->
          <div
            class="search-container"
            id="agentsSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search Agents
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="agentsSearchInput"
                  placeholder="Search by name, ID, email, department..."
                />
              </div>
              <select class="search-filter" id="agentStatusFilter">
                <option value="">All Statuses</option>
                <option value="Available">Available</option>
                <option value="Busy">Busy</option>
                <option value="On Break">On Break</option>
                <option value="In Training">In Training</option>
                <option value="Off Duty">Off Duty</option>
              </select>
              <select class="search-filter" id="agentWorkModeFilter">
                <option value="">All Work Modes</option>
                <option value="Office">Office</option>
                <option value="Remote">Remote</option>
                <option value="Hybrid">Hybrid</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('agents')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="agentsSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (Complaints) -->
          <div
            class="search-container"
            id="complaintsSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search Complaints
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="complaintsSearchInput"
                  placeholder="Search by ticket ID, account, subject..."
                />
              </div>
              <select class="search-filter" id="complaintCategoryFilter">
                <option value="">All Categories</option>
                <option value="ACCOUNT">Account</option>
                <option value="ATM">ATM</option>
                <option value="BRANCH">Branch</option>
                <option value="CARD">Card</option>
                <option value="FD">FD</option>
                <option value="LOAN">Loan</option>
                <option value="MOBILE_BANKING">Mobile Banking</option>
                <option value="NET_BANKING">Net Banking</option>
                <option value="TRANSACTION">Transaction</option>
                <option value="OTHER">Other</option>
              </select>
              <select class="search-filter" id="complaintStatusFilter">
                <option value="">All Statuses</option>
                <option value="OPEN">Open</option>
                <option value="IN_PROGRESS">In Progress</option>
                <option value="ESCALATED">Escalated</option>
                <option value="RESOLVED">Resolved</option>
                <option value="CLOSED">Closed</option>
              </select>
              <select class="search-filter" id="complaintPriorityFilter">
                <option value="">All Priorities</option>
                <option value="LOW">Low</option>
                <option value="MEDIUM">Medium</option>
                <option value="HIGH">High</option>
                <option value="URGENT">Urgent</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('complaints')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="complaintsSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (Disputes) -->
          <div
            class="search-container"
            id="disputesSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search Disputes
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="disputesSearchInput"
                  placeholder="Search by ticket/transaction ID, account..."
                />
              </div>
              <select class="search-filter" id="disputeTypeFilter">
                <option value="">All Types</option>
                <option value="UNAUTHORIZED">Unauthorized</option>
                <option value="FRAUD">Fraud</option>
                <option value="BILLING_ERROR">Billing Error</option>
                <option value="SERVICE_CHARGE">Service Charge</option>
                <option value="OTHER">Other</option>
              </select>
              <select class="search-filter" id="disputeStatusFilter">
                <option value="">All Statuses</option>
                <option value="OPEN">Open</option>
                <option value="UNDER_REVIEW">Under Review</option>
                <option value="APPROVED">Approved</option>
                <option value="REJECTED">Rejected</option>
                <option value="RESOLVED">Resolved</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('disputes')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="disputesSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (Loans) -->
          <div
            class="search-container"
            id="loansSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search Loans
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="loansSearchInput"
                  placeholder="Search by loan/account ID..."
                />
              </div>
              <select class="search-filter" id="loanTypeFilter">
                <option value="">All Types</option>
                <option value="PERSONAL_LOAN">Personal Loan</option>
                <option value="HOME_LOAN">Home Loan</option>
                <option value="CAR_LOAN">Car Loan</option>
                <option value="BUSINESS_LOAN">Business Loan</option>
                <option value="EDUCATION_LOAN">Education Loan</option>
                <option value="GOLD_LOAN">Gold Loan</option>
              </select>
              <select class="search-filter" id="loanStatusFilter">
                <option value="">All Statuses</option>
                <option value="ACTIVE">Active</option>
                <option value="DISBURSED">Disbursed</option>
                <option value="COMPLETED">Completed</option>
                <option value="CLOSED">Closed</option>
                <option value="DEFAULT">Default</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('loans')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="loansSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (FD Rates) -->
          <div
            class="search-container"
            id="fd_ratesSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search FD Rates
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="fd_ratesSearchInput"
                  placeholder="Search by tenure (in days)..."
                />
              </div>
              <select class="search-filter" id="fdCustomerTypeFilter">
                <option value="">All Customer Types</option>
                <option value="NORMAL">Normal</option>
                <option value="SENIOR_CITIZEN">Senior Citizen</option>
              </select>
              <select class="search-filter" id="fdSpecialFeaturesFilter">
                <option value="">All Features</option>
                <option value="CUMULATIVE">Cumulative</option>
                <option value="MONTHLY_PAYOUT">Monthly Payout</option>
                <option value="QUARTERLY_PAYOUT">Quarterly Payout</option>
                <option value="TAX_SAVING">Tax Saving</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('fd_rates')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="fd_ratesSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (Cards) -->
          <div
            class="search-container"
            id="cardsSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search Cards
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="cardsSearchInput"
                  placeholder="Search by card/account number, name..."
                />
              </div>
              <select class="search-filter" id="cardTypeFilter">
                <option value="">All Card Types</option>
                <option value="VISA">Visa</option>
                <option value="MASTERCARD">Mastercard</option>
                <option value="RUPAY">Rupay</option>
              </select>
              <select class="search-filter" id="cardNetworkFilter">
                <option value="">All Networks</option>
                <option value="DEBIT">Debit</option>
                <option value="CREDIT">Credit</option>
              </select>
              <select class="search-filter" id="cardStatusFilter">
                <option value="">All Statuses</option>
                <option value="ACTIVE">Active</option>
                <option value="BLOCKED">Blocked</option>
                <option value="LOST">Lost</option>
                <option value="EXPIRED">Expired</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('cards')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="cardsSearchStats"
              style="display: none"
            ></div>
          </div>

          <!-- Search Container (Cheques) -->
          <div
            class="search-container"
            id="chequesSearchContainer"
            style="display: none"
          >
            <div class="search-header">
              <div class="search-title">
                <i class="fas fa-search me-2"></i>Search Cheques
              </div>
            </div>
            <div class="search-controls">
              <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="chequesSearchInput"
                  placeholder="Search by cheque/account number, payee..."
                />
              </div>
              <select class="search-filter" id="chequeStatusFilter">
                <option value="">All Statuses</option>
                <option value="Cleared">Cleared</option>
                <option value="Pending">Pending</option>
                <option value="Bounced">Bounced</option>
                <option value="Under Process">Under Process</option>
              </select>
              <button
                class="btn btn-outline-secondary btn-sm"
                onclick="clearSearch('cheques')"
              >
                <i class="fas fa-times me-1"></i>Clear
              </button>
            </div>
            <div
              class="search-stats"
              id="chequesSearchStats"
              style="display: none"
            ></div>
          </div>

          <div class="card">
            <div
              class="card-header"
              style="background-color: var(--github-badge-bg)"
            >
              <ul
                class="nav nav-tabs card-header-tabs"
                id="viewTabs"
                role="tablist"
              >
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link active"
                    id="table-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#table"
                    type="button"
                    role="tab"
                  >
                    <i class="fas fa-table me-2"></i>Table View
                  </button>
                </li>
                <li
                  class="nav-item"
                  role="presentation"
                  id="agents-tab-container"
                  style="display: none"
                >
                  <button
                    class="nav-link"
                    id="cards-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#cards"
                    type="button"
                    role="tab"
                  >
                    <i class="fas fa-id-card me-2"></i>Cards View
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link"
                    id="json-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#json"
                    type="button"
                    role="tab"
                  >
                    <i class="fas fa-code me-2"></i>JSON View
                  </button>
                </li>
              </ul>
            </div>
            <div class="card-body">
              <div class="tab-content" id="viewTabsContent">
                <div
                  class="tab-pane fade show active"
                  id="table"
                  role="tabpanel"
                >
                  <div class="table-container">
                    <table class="table">
                      <thead id="tableHeader">
                        <tr>
                          <!-- Dynamically populated -->
                        </tr>
                      </thead>
                      <tbody id="tableBody">
                        <!-- Dynamically populated -->
                      </tbody>
                    </table>
                  </div>
                </div>
                <div class="tab-pane fade" id="cards" role="tabpanel">
                  <div class="agents-container" id="agentsContainer">
                    <!-- Agent cards will be dynamically populated here -->
                  </div>
                </div>
                <div class="tab-pane fade" id="json" role="tabpanel">
                  <div
                    class="json-view"
                    style="
                      background-color: var(--github-badge-bg);
                      border: 1px solid var(--github-border);
                      border-radius: 0;
                      padding: 15px;
                      max-height: 500px;
                      overflow-y: auto;
                    "
                  >
                    <pre
                      id="jsonData"
                      style="
                        color: var(--github-text);
                        font-family: monospace;
                        font-size: 12px;
                        margin: 0;
                      "
                    ></pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <button class="theme-toggle" id="themeToggle">
      <i class="fas fa-moon" id="themeIcon"></i>
    </button>

    <div class="loading-spinner" id="loadingSpinner">
      <div class="spinner"></div>
    </div>

    <!-- JSON Modal -->
    <div class="modal fade" id="jsonModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Record Details</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <pre id="jsonContent"></pre>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // Theme toggle functionality
      const themeToggle = document.getElementById("themeToggle");
      const themeIcon = document.getElementById("themeIcon");
      const html = document.documentElement;

      themeToggle.addEventListener("click", () => {
        if (html.getAttribute("data-bs-theme") === "dark") {
          html.setAttribute("data-bs-theme", "light");
          themeIcon.className = "fas fa-moon";
        } else {
          html.setAttribute("data-bs-theme", "dark");
          themeIcon.className = "fas fa-sun";
        }
      });

      // Dashboard elements
      const loadingSpinner = document.getElementById("loadingSpinner");
      const dataItems = document.querySelectorAll(".data-item");
      const currentDataType = document.getElementById("currentDataType");
      const tableHeader = document.getElementById("tableHeader");
      const tableBody = document.getElementById("tableBody");
      const jsonData = document.getElementById("jsonData");
      const sourceToggle = document.getElementById("sourceToggle");
      const agentsTabContainer = document.getElementById(
        "agents-tab-container"
      );
      const agentsContainer = document.getElementById("agentsContainer");
      const homeDashboard = document.getElementById("homeDashboard");
      const dataViews = document.getElementById("dataViews");

      let currentData = [];
      let currentType = "home";
      let useDatabase = false;
      let charts = {};
      let searchTimeout;

      // Initialize dashboard
      document.addEventListener("DOMContentLoaded", function () {
        initializeEventListeners();
        document.querySelector('.data-item[data-type="home"]').click();
      });

      function showHomeDashboard() {
        homeDashboard.style.display = "block";
        dataViews.style.display = "none";
        loadDashboardData();
      }

      function showDataViews() {
        homeDashboard.style.display = "none";
        dataViews.style.display = "block";
      }

      function navigateToData(dataType) {
        const targetItem = document.querySelector(
          `.data-item[data-type="${dataType}"]`
        );
        if (targetItem) {
          targetItem.click();
        }
      }

      function initializeEventListeners() {
        dataItems.forEach((item) => {
          item.addEventListener("click", function () {
            const dataType = this.dataset.type;
            dataItems.forEach((i) => i.classList.remove("active"));
            this.classList.add("active");

            if (dataType === "home") {
              currentType = "home";
              showHomeDashboard();
            } else {
              showDataViews();
              loadData(dataType);
            }
          });
        });

        sourceToggle.addEventListener("change", function () {
          useDatabase = this.checked;
          if (currentType !== "home") {
            loadData(currentType);
          } else {
            loadDashboardData();
          }
        });

        document.addEventListener("click", function (e) {
          if (e.target && e.target.classList.contains("view-details-btn")) {
            const data = JSON.parse(e.target.dataset.item);
            document.getElementById("jsonContent").textContent = JSON.stringify(
              data,
              null,
              4
            );
            new bootstrap.Modal(document.getElementById("jsonModal")).show();
          }
        });
      }

      async function loadDashboardData() {
        showLoading();
        try {
          const dataTypes = [
            "accounts",
            "transactions",
            "agents",
            "cards",
            "loans",
            "complaints",
          ];
          const dashboardData = {};

          for (const dataType of dataTypes) {
            const source = useDatabase ? "db" : "mock";
            const url = `/dashboard/api?source=${source}&data_type=${dataType}`;
            const response = await fetch(url);

            if (response.ok) {
              const data = await response.json();
              dashboardData[dataType] = data.data || [];
            }
          }

          updateDashboardStats(dashboardData);
          initializeCharts(dashboardData);
          populateActivityFeeds(dashboardData);
        } catch (error) {
          console.error("Error loading dashboard data:", error);
        } finally {
          hideLoading();
        }
      }

      function updateDashboardStats(data) {
        const accounts = data.accounts || [];
        document.getElementById("totalAccounts").textContent =
          accounts.length.toLocaleString();

        const totalBalance = accounts.reduce(
          (sum, account) => sum + (account.balance || 0),
          0
        );
        document.getElementById("totalBalance").textContent =
          "â‚¹" +
          totalBalance.toLocaleString("en-IN", { maximumFractionDigits: 0 });

        const cards = data.cards || [];
        const activeCards = cards.filter(
          (card) => card.card_status === "ACTIVE"
        ).length;
        document.getElementById("activeCards").textContent =
          activeCards.toLocaleString();

        const agents = data.agents || [];
        const availableAgents = agents.filter(
          (agent) => agent.is_available
        ).length;
        document.getElementById("availableAgents").textContent =
          availableAgents.toLocaleString();
      }

      function initializeCharts(data) {
        const isDarkTheme = html.getAttribute("data-bs-theme") === "dark";
        const textColor = isDarkTheme ? "#c9d1d9" : "#24292f";
        const gridColor = isDarkTheme ? "#30363d" : "#d0d7de";

        const chartConfigs = {
          account: {
            ctx: document.getElementById("accountChart").getContext("2d"),
            type: "doughnut",
            data: () => {
              const accountTypes = {};
              (data.accounts || []).forEach((account) => {
                accountTypes[account.account_type] =
                  (accountTypes[account.account_type] || 0) + 1;
              });
              return {
                labels: Object.keys(accountTypes),
                datasets: [
                  {
                    data: Object.values(accountTypes),
                    backgroundColor: [
                      "#0969da",
                      "#1a7f37",
                      "#8250df",
                      "#cf222e",
                      "#bc4c00",
                    ],
                    borderWidth: 0,
                  },
                ],
              };
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  position: "bottom",
                  labels: { color: textColor, font: { size: 11 } },
                },
              },
            },
          },
          transaction: {
            ctx: document.getElementById("transactionChart").getContext("2d"),
            type: "line",
            data: () => {
              const last7Days = Array.from({ length: 7 }, (_, i) => {
                const d = new Date();
                d.setDate(d.getDate() - i);
                return d.toLocaleDateString("en-US", {
                  month: "short",
                  day: "numeric",
                });
              }).reverse();
              const transactionCounts = Array.from(
                { length: 7 },
                () => Math.floor(Math.random() * 100) + 50
              );
              return {
                labels: last7Days,
                datasets: [
                  {
                    label: "Transactions",
                    data: transactionCounts,
                    borderColor: "#0969da",
                    backgroundColor: "rgba(9, 105, 218, 0.1)",
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: "#0969da",
                    pointBorderColor: "#fff",
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6,
                  },
                ],
              };
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                y: {
                  beginAtZero: true,
                  ticks: { color: textColor, font: { size: 10 } },
                  grid: { color: gridColor, drawBorder: false },
                },
                x: {
                  ticks: { color: textColor, font: { size: 10 } },
                  grid: { display: false },
                },
              },
              plugins: {
                legend: { display: false },
                tooltip: {
                  backgroundColor: isDarkTheme ? "#30363d" : "#fff",
                  titleColor: textColor,
                  bodyColor: textColor,
                  borderColor: gridColor,
                  borderWidth: 1,
                },
              },
            },
          },
          loan: {
            ctx: document.getElementById("loanChart").getContext("2d"),
            type: "pie",
            data: () => {
              const loanTypes = {};
              (data.loans || []).forEach((loan) => {
                loanTypes[loan.loan_type || "Personal"] =
                  (loanTypes[loan.loan_type || "Personal"] || 0) + 1;
              });
              return {
                labels: Object.keys(loanTypes),
                datasets: [
                  {
                    data: Object.values(loanTypes),
                    backgroundColor: [
                      "#1a7f37",
                      "#8250df",
                      "#cf222e",
                      "#bc4c00",
                      "#0969da",
                    ],
                    borderWidth: 0,
                  },
                ],
              };
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  position: "bottom",
                  labels: { color: textColor, font: { size: 11 } },
                },
              },
            },
          },
          agent: {
            ctx: document.getElementById("agentChart").getContext("2d"),
            type: "bar",
            data: () => {
              const agentStatus = {};
              (data.agents || []).forEach((agent) => {
                agentStatus[agent.current_status] =
                  (agentStatus[agent.current_status] || 0) + 1;
              });
              return {
                labels: Object.keys(agentStatus),
                datasets: [
                  {
                    label: "Agents",
                    data: Object.values(agentStatus),
                    backgroundColor: [
                      "rgba(26, 127, 55, 0.8)",
                      "rgba(130, 80, 223, 0.8)",
                      "rgba(207, 34, 46, 0.8)",
                      "rgba(188, 76, 0, 0.8)",
                      "rgba(9, 105, 218, 0.8)",
                    ],
                    borderColor: [
                      "#1a7f37",
                      "#8250df",
                      "#cf222e",
                      "#bc4c00",
                      "#0969da",
                    ],
                    borderWidth: 1,
                    borderRadius: 4,
                  },
                ],
              };
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                y: {
                  beginAtZero: true,
                  ticks: { color: textColor, font: { size: 10 } },
                  grid: { color: gridColor, drawBorder: false },
                },
                x: {
                  ticks: { color: textColor, font: { size: 10 } },
                  grid: { display: false },
                },
              },
              plugins: {
                legend: { display: false },
                tooltip: {
                  backgroundColor: isDarkTheme ? "#30363d" : "#fff",
                  titleColor: textColor,
                  bodyColor: textColor,
                  borderColor: gridColor,
                  borderWidth: 1,
                },
              },
            },
          },
        };

        for (const chartName in chartConfigs) {
          if (charts[chartName]) charts[chartName].destroy();
          const config = chartConfigs[chartName];
          charts[chartName] = new Chart(config.ctx, {
            type: config.type,
            data: config.data(),
            options: config.options,
          });
        }
      }

      function initializeSearch(dataType) {
        const searchContainer = document.getElementById(
          `${dataType}SearchContainer`
        );
        if (!searchContainer) return;

        const searchInput = document.getElementById(`${dataType}SearchInput`);
        const filters = searchContainer.querySelectorAll(".search-filter");

        const handler = () => {
          clearTimeout(searchTimeout);
          searchTimeout = setTimeout(() => performSearch(dataType), 300);
        };

        searchInput.addEventListener("input", handler);
        filters.forEach((filter) => filter.addEventListener("change", handler));
      }

      function performSearch(dataType) {
        const startTime = performance.now();
        let results = [...currentData];

        const searchContainer = document.getElementById(
          `${dataType}SearchContainer`
        );
        const searchInput = document.getElementById(`${dataType}SearchInput`);
        const searchTerm = searchInput.value.toLowerCase().trim();

        switch (dataType) {
          case "accounts": {
            const accountType =
              document.getElementById("accountTypeFilter").value;
            const accountStatus = document.getElementById(
              "accountStatusFilter"
            ).value;
            const kycStatus = document.getElementById("kycStatusFilter").value;
            if (searchTerm) {
              results = results.filter((item) =>
                Object.values(item).some((val) =>
                  String(val).toLowerCase().includes(searchTerm)
                )
              );
            }
            if (accountType)
              results = results.filter(
                (item) => item.account_type === accountType
              );
            if (accountStatus)
              results = results.filter(
                (item) => item.account_status === accountStatus
              );
            if (kycStatus)
              results = results.filter((item) => item.kyc_status === kycStatus);
            break;
          }
          case "transactions": {
            const transType = document.getElementById(
              "transactionTypeFilter"
            ).value;
            const transStatus = document.getElementById(
              "transactionStatusFilter"
            ).value;
            if (searchTerm) {
              results = results.filter(
                (item) =>
                  item.id.toLowerCase().includes(searchTerm) ||
                  item.account_number.toLowerCase().includes(searchTerm) ||
                  item.description.toLowerCase().includes(searchTerm)
              );
            }
            if (transType)
              results = results.filter((item) => item.type === transType);
            if (transStatus)
              results = results.filter((item) => item.status === transStatus);
            break;
          }
          case "branches": {
            const branchType =
              document.getElementById("branchTypeFilter").value;
            const branchFacilities = document.getElementById(
              "branchFacilitiesFilter"
            ).value;
            if (searchTerm) {
              results = results.filter(
                (item) =>
                  item.name.toLowerCase().includes(searchTerm) ||
                  item.city.toLowerCase().includes(searchTerm) ||
                  item.ifsc.toLowerCase().includes(searchTerm) ||
                  item.manager_name.toLowerCase().includes(searchTerm)
              );
            }
            if (branchType)
              results = results.filter(
                (item) => item.branch_type === branchType
              );
            if (branchFacilities)
              results = results.filter(
                (item) => item.facilities === branchFacilities
              );
            break;
          }
          case "atms": {
            const atmType = document.getElementById("atmTypeFilter").value;
            const atmStatus = document.getElementById("atmStatusFilter").value;
            if (searchTerm) {
              results = results.filter(
                (item) =>
                  item.id.toLowerCase().includes(searchTerm) ||
                  item.address.toLowerCase().includes(searchTerm) ||
                  item.city.toLowerCase().includes(searchTerm)
              );
            }
            if (atmType)
              results = results.filter((item) => item.type === atmType);
            if (atmStatus)
              results = results.filter((item) => item.status === atmStatus);
            break;
          }
          case "agents": {
            const agentStatus =
              document.getElementById("agentStatusFilter").value;
            const agentWorkMode = document.getElementById(
              "agentWorkModeFilter"
            ).value;
            if (searchTerm) {
              results = results.filter(
                (item) =>
                  item.full_name.toLowerCase().includes(searchTerm) ||
                  item.agent_id.toLowerCase().includes(searchTerm) ||
                  item.employee_id.toLowerCase().includes(searchTerm) ||
                  item.email.toLowerCase().includes(searchTerm) ||
                  item.department.toLowerCase().includes(searchTerm) ||
                  item.specialization.toLowerCase().includes(searchTerm)
              );
            }
            if (agentStatus)
              results = results.filter(
                (item) => item.current_status === agentStatus
              );
            if (agentWorkMode)
              results = results.filter(
                (item) => item.work_mode === agentWorkMode
              );
            break;
          }
          case "complaints": {
            const category = document.getElementById(
              "complaintCategoryFilter"
            ).value;
            const status = document.getElementById(
              "complaintStatusFilter"
            ).value;
            const priority = document.getElementById(
              "complaintPriorityFilter"
            ).value;
            if (searchTerm) {
              results = results.filter(
                (item) =>
                  item.ticket_id.toLowerCase().includes(searchTerm) ||
                  item.account_number.toLowerCase().includes(searchTerm) ||
                  item.subject.toLowerCase().includes(searchTerm)
              );
            }
            if (category)
              results = results.filter((item) => item.category === category);
            if (status)
              results = results.filter((item) => item.status === status);
            if (priority)
              results = results.filter((item) => item.priority === priority);
            break;
          }
          case "disputes": {
            const type = document.getElementById("disputeTypeFilter").value;
            const status = document.getElementById("disputeStatusFilter").value;
            if (searchTerm) {
              results = results.filter(
                (item) =>
                  item.ticket_id.toLowerCase().includes(searchTerm) ||
                  item.account_number.toLowerCase().includes(searchTerm) ||
                  item.transaction_id.toLowerCase().includes(searchTerm)
              );
            }
            if (type)
              results = results.filter((item) => item.dispute_type === type);
            if (status)
              results = results.filter((item) => item.status === status);
            break;
          }
          case "loans": {
            const type = document.getElementById("loanTypeFilter").value;
            const status = document.getElementById("loanStatusFilter").value;
            if (searchTerm) {
              results = results.filter(
                (item) =>
                  item.loan_id.toLowerCase().includes(searchTerm) ||
                  item.account_number.toLowerCase().includes(searchTerm)
              );
            }
            if (type)
              results = results.filter((item) => item.loan_type === type);
            if (status)
              results = results.filter((item) => item.status === status);
            break;
          }
          case "fd_rates": {
            const customerType = document.getElementById(
              "fdCustomerTypeFilter"
            ).value;
            const features = document.getElementById(
              "fdSpecialFeaturesFilter"
            ).value;
            if (searchTerm) {
              results = results.filter((item) =>
                String(item.tenure).includes(searchTerm)
              );
            }
            if (customerType)
              results = results.filter(
                (item) => item.customer_type === customerType
              );
            if (features)
              results = results.filter(
                (item) => item.special_features === features
              );
            break;
          }
          case "cards": {
            const cardType = document.getElementById("cardTypeFilter").value;
            const cardNetwork =
              document.getElementById("cardNetworkFilter").value;
            const cardStatus =
              document.getElementById("cardStatusFilter").value;
            if (searchTerm) {
              results = results.filter(
                (item) =>
                  item.card_number.toLowerCase().includes(searchTerm) ||
                  item.account_number.toLowerCase().includes(searchTerm) ||
                  item.customer_name.toLowerCase().includes(searchTerm)
              );
            }
            if (cardType)
              results = results.filter((item) => item.card_type === cardType);
            if (cardNetwork)
              results = results.filter(
                (item) => item.card_network === cardNetwork
              );
            if (cardStatus)
              results = results.filter(
                (item) => item.card_status === cardStatus
              );
            break;
          }
          case "cheques": {
            const status = document.getElementById("chequeStatusFilter").value;
            if (searchTerm) {
              results = results.filter(
                (item) =>
                  item.cheque_number.toLowerCase().includes(searchTerm) ||
                  item.account_number.toLowerCase().includes(searchTerm) ||
                  item.payee_name.toLowerCase().includes(searchTerm)
              );
            }
            if (status)
              results = results.filter((item) => item.status === status);
            break;
          }
        }

        const endTime = performance.now();
        updateSearchStats(
          dataType,
          currentData.length,
          results.length,
          endTime - startTime
        );
        displaySearchResults(results, searchTerm, dataType);
      }

      function updateSearchStats(dataType, total, filtered, timeMs) {
        const statsContainer = document.getElementById(
          `${dataType}SearchStats`
        );
        if (!statsContainer) return;
        statsContainer.innerHTML = `
                <div class="search-stat"><i class="fas fa-database search-stat-icon"></i><span>${total.toLocaleString()} total</span></div>
                <div class="search-stat"><i class="fas fa-filter search-stat-icon"></i><span>${filtered.toLocaleString()} filtered</span></div>
                <div class="search-stat"><i class="fas fa-clock search-stat-icon"></i><span>${timeMs.toFixed(
                  1
                )}ms</span></div>
            `;
        statsContainer.style.display = "flex";
      }

      function displaySearchResults(results, searchTerm, dataType) {
        if (results.length === 0) {
          if (dataType === "agents") {
            agentsContainer.innerHTML =
              '<div class="col-12 text-center py-5"><div class="no-results"><div class="no-results-icon"><i class="fas fa-search"></i></div><div>No agents found.</div></div></div>';
          }
          tableBody.innerHTML = `<tr><td colspan="100%" class="text-center"><div class="no-results"><div class="no-results-icon"><i class="fas fa-search"></i></div><div>No results found.</div></div></td></tr>`;
          return;
        }

        renderTable(results, searchTerm);
        if (dataType === "agents") {
          renderAgentCards(results, searchTerm);
        }
      }

      function highlightSearchTerm(text, searchTerm) {
        if (!searchTerm || typeof text !== "string") return text;
        const regex = new RegExp(
          `(${searchTerm.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&")})`,
          "gi"
        );
        return text.replace(regex, '<span class="search-highlight">$1</span>');
      }

      function clearSearch(dataType) {
        const searchContainer = document.getElementById(
          `${dataType}SearchContainer`
        );
        if (!searchContainer) return;

        const searchInput = document.getElementById(`${dataType}SearchInput`);
        searchInput.value = "";

        const filters = searchContainer.querySelectorAll(".search-filter");
        filters.forEach((filter) => (filter.value = ""));

        const statsContainer = document.getElementById(
          `${dataType}SearchStats`
        );
        statsContainer.style.display = "none";

        renderTable(currentData);
        if (dataType === "agents") {
          renderAgentCards(currentData);
        }
      }

      function populateActivityFeeds(data) {
        const activityFeed = document.getElementById("activityFeed");
        const alertsFeed = document.getElementById("alertsFeed");
        const activities = [];
        (data.accounts || [])
          .slice(0, 3)
          .forEach((account) =>
            activities.push({
              icon: "fa-user-plus",
              color: "#1a7f37",
              title: "New Account Created",
              description: `${account.customer_name} - ${account.account_type}`,
              time: "Just now",
            })
          );
        (data.transactions || [])
          .slice(0, 3)
          .forEach((transaction) =>
            activities.push({
              icon: "fa-exchange-alt",
              color: "#0969da",
              title: "Transaction Processed",
              description: `${transaction.type} - â‚¹${transaction.amount}`,
              time: "2 mins ago",
            })
          );

        if (activityFeed) {
          activityFeed.innerHTML = activities
            .slice(0, 5)
            .map(
              (activity) =>
                `<div class="activity-item"><div class="activity-icon" style="background: ${activity.color}20; color: ${activity.color};"><i class="fas ${activity.icon}"></i></div><div class="activity-content"><div class="activity-title">${activity.title}</div><div class="activity-description">${activity.description}</div><div class="activity-time">${activity.time}</div></div></div>`
            )
            .join("");
        }

        const alerts = [
          {
            icon: "fa-exclamation-triangle",
            color: "#bc4c00",
            title: "High Transaction Volume",
            description: "Transaction volume increased by 25% today",
            time: "5 mins ago",
          },
          {
            icon: "fa-info-circle",
            color: "#0969da",
            title: "System Maintenance",
            description: "Scheduled maintenance tonight at 2 AM",
            time: "1 hour ago",
          },
          {
            icon: "fa-check-circle",
            color: "#1a7f37",
            title: "Backup Completed",
            description: "Daily backup completed successfully",
            time: "2 hours ago",
          },
        ];

        if (alertsFeed) {
          alertsFeed.innerHTML = alerts
            .map(
              (alert) =>
                `<div class="activity-item"><div class="activity-icon" style="background: ${alert.color}20; color: ${alert.color};"><i class="fas ${alert.icon}"></i></div><div class="activity-content"><div class="activity-title">${alert.title}</div><div class="activity-description">${alert.description}</div><div class="activity-time">${alert.time}</div></div></div>`
            )
            .join("");
        }
      }

      function updateAccountChart(type) {
        console.log("Updating account chart:", type);
      }
      function updateTransactionChart(period) {
        console.log("Updating transaction chart:", period);
      }
      function updateLoanChart(type) {
        console.log("Updating loan chart:", type);
      }
      function updateAgentChart(metric) {
        console.log("Updating agent chart:", metric);
      }

      function showLoading() {
        loadingSpinner.style.display = "block";
      }
      function hideLoading() {
        loadingSpinner.style.display = "none";
      }

      async function loadData(dataType) {
        showLoading();
        currentType = dataType;
        currentDataType.textContent =
          dataType.charAt(0).toUpperCase() +
          dataType.slice(1).replace(/_/g, " ");

        document
          .querySelectorAll(".search-container")
          .forEach((c) => (c.style.display = "none"));
        const currentSearchContainer = document.getElementById(
          `${dataType}SearchContainer`
        );
        if (currentSearchContainer) {
          currentSearchContainer.style.display = "block";
          clearSearch(dataType);
          initializeSearch(dataType);
        }

        const isAgents = dataType === "agents";
        agentsTabContainer.style.display = isAgents ? "block" : "none";
        const tableTab = new bootstrap.Tab(
          document.getElementById("table-tab")
        );
        const cardsTab = new bootstrap.Tab(
          document.getElementById("cards-tab")
        );
        isAgents ? cardsTab.show() : tableTab.show();

        try {
          const source = useDatabase ? "db" : "mock";
          const url = `/dashboard/api?source=${source}&data_type=${dataType}`;
          const response = await fetch(url);
          if (!response.ok)
            throw new Error(`HTTP error! status: ${response.status}`);

          const data = await response.json();
          currentData = data.data || [];
          renderTable(currentData);
          if (isAgents) renderAgentCards(currentData);
          renderJson(currentData);
        } catch (error) {
          console.error("Error loading data:", error);
          renderTable([]);
          if (isAgents) renderAgentCards([]);
          renderJson([]);
        } finally {
          hideLoading();
        }
      }

      function renderTable(data, searchTerm = "") {
        if (!data || data.length === 0) {
          tableHeader.innerHTML = "<tr><th>No data available</th></tr>";
          tableBody.innerHTML = "";
          return;
        }

        tableHeader.innerHTML = "";
        tableBody.innerHTML = "";

        const headerRow = document.createElement("tr");
        Object.keys(data[0]).forEach((key) => {
          const th = document.createElement("th");
          th.textContent = key
            .replace(/_/g, " ")
            .replace(/\b\w/g, (l) => l.toUpperCase());
          headerRow.appendChild(th);
        });
        tableHeader.appendChild(headerRow);

        data.forEach((item) => {
          const row = document.createElement("tr");
          Object.keys(item).forEach((key) => {
            const td = document.createElement("td");
            let value = item[key];

            if (typeof value === "object" && value !== null) {
              const btn = document.createElement("button");
              btn.className = "btn btn-sm btn-outline-primary view-details-btn";
              btn.textContent = "View Details";
              btn.dataset.item = JSON.stringify(value);
              td.appendChild(btn);
            } else {
              const textValue = String(value ?? "");
              td.innerHTML = highlightSearchTerm(textValue, searchTerm);
            }
            row.appendChild(td);
          });
          tableBody.appendChild(row);
        });
      }

      function renderJson(data) {
        jsonData.textContent = JSON.stringify(data, null, 4);
      }

      function renderAgentCards(data, searchTerm = "") {
        if (!data || data.length === 0) {
          agentsContainer.innerHTML =
            '<div class="col-12 text-center py-5">No agents data available</div>';
          return;
        }

        agentsContainer.innerHTML = data
          .map((agent, index) => {
            const initials = agent.full_name
              ? agent.full_name
                  .split(" ")
                  .map((n) => n[0])
                  .join("")
                  .toUpperCase()
              : "AG";
            const statusClass = getStatusClass(agent.current_status);
            const skills = (agent.skills || [])
              .slice(0, 4)
              .map((skill) => `<span class="skill-badge">${skill}</span>`)
              .join("");

            return `
                    <div class="agent-card" style="animation-delay: ${
                      index * 0.1
                    }s;">
                        <div class="agent-header">
                            <div class="agent-avatar">${initials}</div>
                            <div class="agent-info"><h5>${highlightSearchTerm(
                              agent.full_name || "N/A",
                              searchTerm
                            )}</h5><p>${highlightSearchTerm(
              agent.agent_id || "N/A",
              searchTerm
            )} â€¢ ${highlightSearchTerm(
              agent.department || "N/A",
              searchTerm
            )}</p></div>
                        </div>
                        <div class="agent-status ${statusClass}">${
              agent.current_status || "N/A"
            }</div>
                        <div class="agent-details">
                            <div class="detail-row"><span>Specialization:</span><span>${highlightSearchTerm(
                              agent.specialization || "N/A",
                              searchTerm
                            )}</span></div>
                            <div class="detail-row"><span>Experience:</span><span>${
                              agent.years_experience || 0
                            } years</span></div>
                            <div class="detail-row"><span>Location:</span><span>${
                              agent.base_city || "N/A"
                            }</span></div>
                            <div class="detail-row"><span>Work Mode:</span><span>${
                              agent.work_mode || "N/A"
                            }</span></div>
                        </div>
                        <div class="agent-skills">${skills}</div>
                        <div class="agent-metrics">
                            <div class="metric"><div class="metric-value">${
                              agent.performance_rating || 0
                            }</div><div class="metric-label">Rating</div></div>
                            <div class="metric"><div class="metric-value">${
                              agent.customer_satisfaction_rate || 0
                            }%</div><div class="metric-label">Satisfaction</div></div>
                            <div class="metric"><div class="metric-value">${
                              agent.cases_handled || 0
                            }</div><div class="metric-label">Cases</div></div>
                        </div>
                    </div>`;
          })
          .join("");
      }

      function getStatusClass(status) {
        switch (status?.toLowerCase()) {
          case "available":
            return "status-available";
          case "busy":
            return "status-busy";
          case "on break":
            return "status-break";
          case "in training":
            return "status-training";
          case "off duty":
            return "status-off";
          default:
            return "status-off";
        }
      }
    </script>
  </body>
</html>
